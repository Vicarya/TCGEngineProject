# TCG Engine - Action Plan

## 1. ドキュメントの目的と運用ルール

このドキュメントは、本TCGエンジンを「ヴァイスシュヴァルツの対戦シミュレーションが可能なゲーム」として完成させるための開発ロードマップです。

### 運用ルール
- **担当の明確化**: タスクに着手する際は、担当者欄に自分の名前を記載してください。
- **ステータスの更新**: タスクの進捗に応じて、ステータスを `未着手` -> `進行中` -> `完了` に更新してください。
- **タスクの追加**: 新しいタスクは、関連するマイルストーンの下に追加してください。大きなタスクは、関係者と合意の上で追加します。
- **完了の定義**: 「完了」とは、実装が完了し、関連するテストが成功した状態を指します。
- **タスクの分割と確認**: 予期せぬ中断リスクを考慮し、タスクは可能な限り短く区切って実装してください。一つの区切りがついたら、コンパイルや簡単な動作確認を行い、問題がなければ進捗を更新（またはコミット）することを推奨します。

---

## 2. 長期マイルストーン

ゴールに向けた高レベルな開発フェーズです。

| マイルストーン | 内容 | ステータス |
| :--- | :--- | :--- |
| **M1: コアロジックの実装完了** | ゲームのセットアップからターン進行、フェーズ遷移、基本的なルール処理（ダメージ計算、レベルアップ等）まで、バックエンドのロジックを完成させる。 | `進行中` |
| **M1.5: アーキテクチャのリファクタリング** | GameCoreとゲーム固有実装の分離を徹底し、設計をクリーンに保つための改善作業。 | `進行中` |
| **M2: UIとゲームロジックの接続** | Unity上でゲームの状態（手札、場、リソース等）が可視化され、更新が反映されるようにする。 | `未着手` |
| **M3: プレイヤー入力の実装** | UIを通じて、プレイヤーが「カードをプレイする」「アタックする」といった基本的なゲーム内アクションを行えるようにする。 | `未着手` |
| **M4: カード能力の拡充と自動化** | `AbilityFactory` を拡張し、多様なカード能力（効果、コスト、誘発条件）をデータ定義から自動生成・実行できるようにする。 | `未着手` |
| **M5: 対戦とテスト** | 2人対戦が可能になり、主要なカードの相互作用が正しく機能することを確認する。バグ修正とパフォーマンス改善を中心に行う。 | `未着手` |

---

## 3. 直近の詳細タスク (M1 & M2の開始)

まずはゲームの土台となるコアロジックと、それを表示するための最低限のUIを構築します。

### M1: コアロジックの実装

*Note: 基本的なロジックは実装済みですが、マリガン、カウンター、アンコールなどの詳細なルールや、プレイヤー入力の完全な実装は今後のタスクとなります。*

| タスク ID | タスク内容 | 担当者 | ステータス |
| :--- | :--- | :--- | :--- |
| **T-01** | **ゲーム初期化処理 (`WeissGame.SetupGame`)**: プレイヤー作成、ゾーン初期化、デッキ読込とシャッフル、初期手札ドロー、マリガン処理を実装する。 | Gemini | `進行中` |
| **T-02** | **カードデータベースの構築**: カードデータを定義するJSON形式を決定し、ゲーム開始時に読み込む `CardLoader` クラスを作成する。(旧`CardDatabase`)。まずはサンプルカード10枚程度でよい。 | Gemini | `進行中` |
| **T-03** | **基本フェーズ遷移の実装**: Stand -> Draw -> Clock -> Main -> Climax -> Attack -> End の自動遷移ロジックを `WeissRuleEngine` に実装する。 | Gemini | `進行中` |
| **T-04** | **メインフェイズのアクションループ (`MainPhase.cs`)**: プレイヤーがアクション（カードプレイ、能力起動など）を任意に実行し、フェイズ終了を宣言できるループ処理を実装する。 | Gemini | `進行中` |
| **T-05** | **アタックフェイズの基本処理 (`AttackPhase.cs`)**: アタック宣言、ダメージ計算、戦闘解決（リバース処理）の基本フローを実装する。（カウンター、アンコールは後回し） | Gemini | `進行中` |

### M1.5: アーキテクチャのリファクタリング

| タスク ID | タスク内容 | 担当者 | ステータス |
| :--- | :--- | :--- | :--- |
| **T-R1** | **ゾーン関連インターフェースの移行**: `IDeckZone`, `IHandZone`など、`GameCore`に誤って配置されているゲーム固有のインターフェースを、`WeissSchwarz`配下に移動する。 | Gemini | `進行中` |

### M2: UIとゲームロジックの接続

| タスク ID | タスク内容 | 担当者 | ステータス |
| :--- | :--- | :--- | :--- |
| **T-06** | **`GameManager` の作成**: Unityのシーンに配置するMonoBehaviour。`WeissGame` インスタンスを保持し、ゲームの開始と更新（`Update`）を管理する。 | | `未着手` |
| **T-07** | **UIプレハブの作成**: カード、各種ゾーン（手札、舞台、山札など）、プレイヤー情報（レベル、クロック）を表示するための基本的なUIプレハブを作成する。 | | `未着手` |
| **T-08** | **UI表示ロジックの実装**: `GameManager` が `GameState` の変更を検知し、UIプレハブをインスタンス化・更新する処理を実装する。（例: 手札にカードが加わったら、手札ゾーンにカードUIを追加する） | | `未-着手` |
| **T-09** | **イベントログUIの作成**: `EventBus` が発行したイベントを画面に表示するシンプルなログウィンドウを作成する。デバッグに役立つ。 | | `未着手` |
